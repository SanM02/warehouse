<div class="container-fluid px-4">
  <h1 class="mt-4">Dashboard Menu</h1>
  <ol class="breadcrumb mb-4">
    <li class="breadcrumb-item active">Control de Ferreter√≠a</li>
  </ol>

  <!-- üîß Stats Cards - Estilo Industrial Blueprint -->
  <div class="stats-grid" *ngIf="stats">
    <div class="stat-card accent-orange">
      <div class="stat-label">Ventas Hoy</div>
      <div class="stat-value">{{ stats.ventas_hoy | number:'1.0-0' }}</div>
      <div class="stat-icon">
        <i class="fas fa-cash-register"></i>
      </div>
    </div>
    
    <div class="stat-card accent-green">
      <div class="stat-label">Ventas del Mes</div>
      <div class="stat-value">{{ stats.ventas_mes | number:'1.0-0' }}</div>
      <div class="stat-icon">
        <i class="fas fa-chart-line"></i>
      </div>
    </div>
    
    <div class="stat-card accent-navy">
      <div class="stat-label">Productos Vendidos Hoy</div>
      <div class="stat-value no-currency">{{ stats.productos_vendidos_hoy }}</div>
      <div class="stat-icon">
        <i class="fas fa-boxes"></i>
      </div>
    </div>
    
    <div class="stat-card accent-steel">
      <div class="stat-label">Clientes √önicos</div>
      <div class="stat-value no-currency">{{ stats.clientes_unicos_mes }}</div>
      <div class="stat-icon">
        <i class="fas fa-users-cog"></i>
      </div>
    </div>
  </div>

  <!-- üèóÔ∏è Informaci√≥n Principal - Cards Met√°licos -->
  <div class="row">
    <div class="col-xl-6">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-wrench"></i>
          Resumen de Operaciones
        </div>
        <div class="card-body">
          <div class="row text-center mb-4">
            <div class="col-6">
              <div class="display-number success">{{ ventasHoy || 0 | number:'1.0-0' }}</div>
              <small class="text-muted" style="font-family: 'Barlow Condensed', sans-serif; text-transform: uppercase; letter-spacing: 1px;">Ventas Hoy</small>
            </div>
            <div class="col-6">
              <div class="display-number">{{ ventasMes || 0 | number:'1.0-0' }}</div>
              <small class="text-muted" style="font-family: 'Barlow Condensed', sans-serif; text-transform: uppercase; letter-spacing: 1px;">Este Mes</small>
            </div>
          </div>
          <hr style="border-top: 2px solid var(--industrial-dark); opacity: 0.2;">
          <div class="row text-center mt-4">
            <div class="col-6">
              <div class="display-number info">{{ facturasDia || 0 }}</div>
              <small class="text-muted" style="font-family: 'Barlow Condensed', sans-serif; text-transform: uppercase; letter-spacing: 1px;">Facturas Hoy</small>
            </div>
            <div class="col-6">
              <div class="display-number warning">{{ promedioVenta || 0 | number:'1.0-0' }}</div>
              <small class="text-muted" style="font-family: 'Barlow Condensed', sans-serif; text-transform: uppercase; letter-spacing: 1px;">Promedio Venta</small>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-6">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-tools"></i>
          Productos Destacados
        </div>
        <div class="card-body">
          <div class="list-group list-group-flush">
            <div class="list-group-item d-flex justify-content-between align-items-center" 
                 *ngFor="let producto of productos?.slice(0, 5); trackBy: trackByProducto">
              <div>
                <strong>{{ producto.nombre }}</strong>
                <br>
                <small class="text-muted" style="font-family: 'Work Sans', sans-serif;">{{ producto.marca }}</small>
              </div>
              <div class="text-end">
                <span class="badge bg-success">{{ producto.cantidad_vendida }} uds</span>
                <br>
                <small style="font-family: 'Barlow Condensed', sans-serif; font-weight: 600; color: var(--industrial-green);">‚Ç≤{{ producto.ingresos_totales | number:'1.0-0' }}</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- üè≠ Informaci√≥n Secundaria - Rendimiento Industrial -->
  <div class="row">
    <div class="col-xl-6">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-industry"></i>
          Marcas con Mayor Rendimiento
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-12" *ngFor="let marca of marcas?.slice(0, 4); trackBy: trackByMarca">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <span style="font-family: 'Barlow Condensed', sans-serif; font-size: 1.1rem; font-weight: 700; text-transform: uppercase; color: var(--industrial-dark);">{{ marca.marca }}</span>
                <div>
                  <span class="badge bg-primary me-2">{{ marca.productos_vendidos }} pzas</span>
                  <span style="font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 1.1rem; color: var(--industrial-green);">‚Ç≤{{ marca.ingresos_totales | number:'1.0-0' }}</span>
                </div>
              </div>
              <div class="progress mb-3">
                <div class="progress-bar" 
                     [style.width.%]="(marca.ingresos_totales / maxIngresosMarca * 100)">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-6">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-warehouse"></i>
          Estado de Inventario
        </div>
        <div class="card-body">
          <div class="row text-center mb-4">
            <div class="col-4">
              <div class="display-number success" style="font-size: 2rem;">{{ stockAlto || 0 }}</div>
              <small class="text-muted" style="font-family: 'Barlow Condensed', sans-serif; text-transform: uppercase; letter-spacing: 1px;">Stock Alto</small>
            </div>
            <div class="col-4">
              <div class="display-number warning" style="font-size: 2rem;">{{ stockMedio || 0 }}</div>
              <small class="text-muted" style="font-family: 'Barlow Condensed', sans-serif; text-transform: uppercase; letter-spacing: 1px;">Stock Medio</small>
            </div>
            <div class="col-4">
              <div class="display-number" style="font-size: 2rem; color: #dc2626;">{{ stockBajo || 0 }}</div>
              <small class="text-muted" style="font-family: 'Barlow Condensed', sans-serif; text-transform: uppercase; letter-spacing: 1px;">Stock Bajo</small>
            </div>
          </div>
          <div *ngIf="(stockBajo || 0) > 0" style="background: #fef3c7; border: 3px solid #f59e0b; padding: 1rem; margin-top: 1rem;">
            <i class="fas fa-exclamation-triangle" style="color: #f59e0b; margin-right: 0.5rem;"></i>
            <span style="font-family: 'Barlow Condensed', sans-serif; font-weight: 700; text-transform: uppercase; color: #92400e;">Atenci√≥n:</span>
            <span style="font-family: 'Work Sans', sans-serif; color: #92400e;"> {{ stockBajo }} productos con stock bajo</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tablas de detalles -->
  <div class="row">
    <div class="col-xl-6">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-trophy me-1"></i>
          Top Productos
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Producto</th>
                  <th>Marca</th>
                  <th>Vendidos</th>
                  <th>Ingresos</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let producto of productos">
                  <td>{{ producto.nombre }}</td>
                  <td>{{ producto.marca }}</td>
                  <td>{{ producto.cantidad_vendida }}</td>
                  <td>{{ producto.ingresos_totales | number:'1.0-0' }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-6">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-star me-1"></i>
          Clientes VIP
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Cliente</th>
                  <th>Compras</th>
                  <th>Total Gastado</th>
                  <th>√öltima Compra</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let cliente of clientes">
                  <td>{{ cliente.nombre }}</td>
                  <td>{{ cliente.total_compras }}</td>
                  <td>{{ cliente.total_gastado | number:'1.0-0' }}</td>
                  <td>{{ cliente.ultima_compra | date:'dd/MM/yyyy' }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Resumen de marcas -->
  <div class="row">
    <div class="col-xl-12">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-tags me-1"></i>
          Rendimiento por Marcas
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead class="table-dark">
                <tr>
                  <th>Marca</th>
                  <th>Productos Vendidos</th>
                  <th>Ingresos Totales</th>
                  <th>Promedio por Producto</th>
                  <th>Rendimiento</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let marca of marcas">
                  <td><strong>{{ marca.marca }}</strong></td>
                  <td>{{ marca.productos_vendidos }}</td>
                  <td>{{ marca.ingresos_totales | number:'1.0-0' }}</td>
                  <td>{{ (marca.ingresos_totales / marca.productos_vendidos) | number:'1.0-0' }}</td>
                  <td>
                    <span class="badge" 
                          [class.bg-success]="marca.ingresos_totales > 8000"
                          [class.bg-warning]="marca.ingresos_totales > 5000 && marca.ingresos_totales <= 8000"
                          [class.bg-secondary]="marca.ingresos_totales <= 5000">
                      {{ marca.ingresos_totales > 8000 ? 'Excelente' : marca.ingresos_totales > 5000 ? 'Bueno' : 'Regular' }}
                    </span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
