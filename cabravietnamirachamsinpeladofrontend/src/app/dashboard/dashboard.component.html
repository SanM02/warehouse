<div class="container-fluid px-4">
  <h1 class="mt-4">Dashboard Menu</h1>
  <ol class="breadcrumb mb-4">
    <li class="breadcrumb-item active">Dashboard</li>
  </ol>

  <!-- Tarjetas de estadísticas -->
  <div class="row" *ngIf="stats">
    <div class="col-xl-3 col-md-6">
      <div class="card bg-primary text-white mb-4">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <div class="text-xs font-weight-bold text-uppercase mb-1">Ventas Hoy</div>
              <div class="h5 mb-0 font-weight-bold">{{ stats.ventas_hoy | number:'1.0-0' }}</div>
            </div>
            <div class="fa-2x">
              <i class="fas fa-dollar-sign"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-md-6">
      <div class="card bg-success text-white mb-4">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <div class="text-xs font-weight-bold text-uppercase mb-1">Ventas del Mes</div>
              <div class="h5 mb-0 font-weight-bold">{{ stats.ventas_mes | number:'1.0-0' }}</div>
            </div>
            <div class="fa-2x">
              <i class="fas fa-chart-line"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-md-6">
      <div class="card bg-info text-white mb-4">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <div class="text-xs font-weight-bold text-uppercase mb-1">Productos Vendidos Hoy</div>
              <div class="h5 mb-0 font-weight-bold">{{ stats.productos_vendidos_hoy }}</div>
            </div>
            <div class="fa-2x">
              <i class="fas fa-box"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-md-6">
      <div class="card bg-warning text-white mb-4">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <div class="text-xs font-weight-bold text-uppercase mb-1">Clientes Únicos</div>
              <div class="h5 mb-0 font-weight-bold">{{ stats.clientes_unicos_mes }}</div>
            </div>
            <div class="fa-2x">
              <i class="fas fa-users"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Información principal -->
  <div class="row">
    <div class="col-xl-6">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-cash-register me-1"></i>
          Resumen de Ventas
        </div>
        <div class="card-body">
          <div class="row text-center">
            <div class="col-6">
              <h3 class="text-success">{{ ventasHoy || 0 | number:'1.0-0' }}</h3>
              <small class="text-muted">Ventas Hoy</small>
            </div>
            <div class="col-6">
              <h3 class="text-primary">{{ ventasMes || 0 | number:'1.0-0' }}</h3>
              <small class="text-muted">Este Mes</small>
            </div>
          </div>
          <hr>
          <div class="row text-center">
            <div class="col-6">
              <h4 class="text-info">{{ facturasDia || 0 }}</h4>
              <small class="text-muted">Facturas Hoy</small>
            </div>
            <div class="col-6">
              <h4 class="text-warning">{{ promedioVenta || 0 | number:'1.0-0' }}</h4>
              <small class="text-muted">Promedio por Venta</small>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-6">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-box me-1"></i>
          Productos Destacados
        </div>
        <div class="card-body">
          <div class="list-group list-group-flush">
            <div class="list-group-item d-flex justify-content-between align-items-center" 
                 *ngFor="let producto of productos?.slice(0, 5); trackBy: trackByProducto">
              <div>
                <strong>{{ producto.nombre }}</strong>
                <br>
                <small class="text-muted">{{ producto.marca }}</small>
              </div>
              <div class="text-end">
                <span class="badge bg-success rounded-pill">{{ producto.cantidad_vendida }}</span>
                <br>
                <small class="text-muted">₲{{ producto.ingresos_totales | number:'1.0-0' }}</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Información secundaria -->
  <div class="row">
    <div class="col-xl-6">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-tags me-1"></i>
          Marcas Principales
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-12" *ngFor="let marca of marcas?.slice(0, 4); trackBy: trackByMarca">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <span class="fw-bold">{{ marca.marca }}</span>
                <div>
                  <span class="badge bg-primary me-2">{{ marca.productos_vendidos }} productos</span>
                  <span class="text-success fw-bold">₲{{ marca.ingresos_totales | number:'1.0-0' }}</span>
                </div>
              </div>
              <div class="progress mb-3" style="height: 8px;">
                <div class="progress-bar bg-success" 
                     [style.width.%]="(marca.ingresos_totales / maxIngresosMarca) * 100"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-6">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-warehouse me-1"></i>
          Estado de Inventario
        </div>
        <div class="card-body">
          <div class="row text-center mb-3">
            <div class="col-4">
              <h5 class="text-success">{{ stockAlto || 0 }}</h5>
              <small class="text-muted">Stock Alto</small>
            </div>
            <div class="col-4">
              <h5 class="text-warning">{{ stockMedio || 0 }}</h5>
              <small class="text-muted">Stock Medio</small>
            </div>
            <div class="col-4">
              <h5 class="text-danger">{{ stockBajo || 0 }}</h5>
              <small class="text-muted">Stock Bajo</small>
            </div>
          </div>
          <div class="alert alert-warning" *ngIf="(stockBajo || 0) > 0">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <strong>Atención:</strong> {{ stockBajo }} productos con stock bajo
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tablas de detalles -->
  <div class="row">
    <div class="col-xl-6">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-trophy me-1"></i>
          Top Productos
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Producto</th>
                  <th>Marca</th>
                  <th>Vendidos</th>
                  <th>Ingresos</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let producto of productos">
                  <td>{{ producto.nombre }}</td>
                  <td>{{ producto.marca }}</td>
                  <td>{{ producto.cantidad_vendida }}</td>
                  <td>{{ producto.ingresos_totales | number:'1.0-0' }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-6">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-star me-1"></i>
          Clientes VIP
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Cliente</th>
                  <th>Compras</th>
                  <th>Total Gastado</th>
                  <th>Última Compra</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let cliente of clientes">
                  <td>{{ cliente.nombre }}</td>
                  <td>{{ cliente.total_compras }}</td>
                  <td>{{ cliente.total_gastado | number:'1.0-0' }}</td>
                  <td>{{ cliente.ultima_compra | date:'dd/MM/yyyy' }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Resumen de marcas -->
  <div class="row">
    <div class="col-xl-12">
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-tags me-1"></i>
          Rendimiento por Marcas
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead class="table-dark">
                <tr>
                  <th>Marca</th>
                  <th>Productos Vendidos</th>
                  <th>Ingresos Totales</th>
                  <th>Promedio por Producto</th>
                  <th>Rendimiento</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let marca of marcas">
                  <td><strong>{{ marca.marca }}</strong></td>
                  <td>{{ marca.productos_vendidos }}</td>
                  <td>{{ marca.ingresos_totales | number:'1.0-0' }}</td>
                  <td>{{ (marca.ingresos_totales / marca.productos_vendidos) | number:'1.0-0' }}</td>
                  <td>
                    <span class="badge" 
                          [class.bg-success]="marca.ingresos_totales > 8000"
                          [class.bg-warning]="marca.ingresos_totales > 5000 && marca.ingresos_totales <= 8000"
                          [class.bg-secondary]="marca.ingresos_totales <= 5000">
                      {{ marca.ingresos_totales > 8000 ? 'Excelente' : marca.ingresos_totales > 5000 ? 'Bueno' : 'Regular' }}
                    </span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
